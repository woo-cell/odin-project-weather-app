(()=>{"use strict";class e{constructor(){this.openWeatherBaseUrl="https://api.openweathermap.org",this.key="8d3ddf6f7bb003167b9c01b888993ef4",this.restcountriesBaseUrl="https://restcountries.com/v3.1/name",this.iconBaseUrl="https://openweathermap.org/img/wn"}getGeocodeUrl(e){return`${this.openWeatherBaseUrl}/geo/1.0/direct?appid=${this.key}&q=${e}`}getForecastUrl(e,t,n){return`${this.openWeatherBaseUrl}/data/2.5/forecast?appid=${this.key}&lat=${e}&lon=${t}&units=${n}&cnt=40`}getRestcountriesUrl(e){return`${this.restcountriesBaseUrl}/${e}`}getIconUrl(e){return`${this.iconBaseUrl}/${e}@2x.png`}}function t(e){const t=e.map((e=>e.weather[0].description)),n={};t.forEach((e=>{n[e]?n[e]++:n[e]=1}));const o=Object.entries(n);return o.sort(((e,t)=>t[1]-e[1])),o[0][0]}function n(e){const t=e.sort(((e,t)=>e.main.temp-t.main.temp));return((t[0].main.temp+t[7].main.temp)/2).toFixed(2)}function o(t,n){const o=n.find((e=>e.weather[0].description===t));return(new e).getIconUrl(o.weather[0].icon)}function r(e){return`${e.getDate()<10?`0${e.getDate()}`:e.getDate()} ${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]} ${e.getFullYear()}`}function s(e){return`${e.getHours()<10?`0${e.getHours()}`:e.getHours()}:${e.getMinutes()<10?`0${e.getMinutes()}`:e.getMinutes()}`}class c{constructor(e,t){this.obj=e,this.units=t}populateUI(){this.populateTemperatureNow(),this.populateInfoNow(),this.populateOtherInfos(),this.populateForecast()}populateTemperatureNow(){const e=document.querySelector(".temp"),t=document.querySelector(".feels-like");e.textContent=`${this.obj.list[0].main.temp} ${"metric"===units?"°C":"°F"}`,t.textContent=`feels like ${this.obj.list[0].main.feels_like} ${"metric"===this.units?"°C":"°F"}`}populateInfoNow(){const t=document.querySelector(".desc"),n=document.querySelector(".info-now > img"),o=document.querySelector(".date");t.textContent=`${this.obj.list[0].weather[0].description}`,n.src=(new e).getIconUrl(this.obj.list[0].weather[0].icon),n.alt=`${this.obj.list[0].weather[0].description}`;const r=function(e){const t=new Date,n=t.getTime()+6e4*t.getTimezoneOffset(),{timezone:o}=e.city;return new Date(n+1e3*o)}(this.obj);o.textContent=function(e){const t=e.getDate()<10?`0${e.getDate()}`:e.getDate(),n=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],o=e.getHours()<10?`0${e.getHours()}`:e.getHours(),r=e.getMinutes()<10?`0${e.getMinutes()}`:e.getMinutes();return`${t} ${n} ${e.getFullYear()}, ${o}:${r}`}(r)}populateOtherInfos(){const e=document.querySelector(".pressure"),t=document.querySelector(".humidity"),n=document.querySelector(".cloudiness"),o=document.querySelector(".wind"),r=document.querySelector(".sunrise"),c=document.querySelector(".sunset");e.textContent=`pressure: ${this.obj.list[0].main.pressure} hPa`,t.textContent=`humidity: ${this.obj.list[0].main.humidity} %`,n.textContent=`cloudiness: ${this.obj.list[0].clouds.all} %`,o.textContent=`wind speed: ${this.obj.list[0].wind.speed} ${"metric"===this.units?"meter/s":"miles/h"}`;const u=function(e){const{sunrise:t}=e.city,n=6e4*(new Date).getTimezoneOffset(),{timezone:o}=e.city;return new Date(1e3*t+(1e3*o+n))}(this.obj);r.textContent=`sunrise: ${s(u)}`;const i=function(e){const{sunset:t}=e.city,n=6e4*(new Date).getTimezoneOffset(),{timezone:o}=e.city;return new Date(1e3*t+(1e3*o+n))}(this.obj);c.textContent=`sunset: ${s(i)}`}populateForecast(){const e=document.querySelector(".date-d-one"),s=document.querySelector(".temp-d-one"),c=document.querySelector(".desc-d-one"),u=document.querySelector(".img-d-one"),i=document.querySelector(".date-d-two"),a=document.querySelector(".temp-d-two"),l=document.querySelector(".desc-d-two"),d=document.querySelector(".img-d-two"),m=document.querySelector(".date-d-three"),h=document.querySelector(".temp-d-three"),y=document.querySelector(".desc-d-three"),p=document.querySelector(".img-d-three"),g=function(e){const t=new Date,n=t.getTime()+6e4*t.getTimezoneOffset(),{timezone:o}=e.city,r=1e3*o;return{dPlusOne:new Date(n+r+864e5),dPlusTwo:new Date(n+r+1728e5),dPlusThree:new Date(n+r+2592e5)}}(this.obj);e.textContent=r(g.dPlusOne),i.textContent=r(g.dPlusTwo),m.textContent=r(g.dPlusThree);const w=function(e){const t=e.list[0].dt_txt,n=t[11]+t[12],o=[["00",7],["03",6],["06",5],["09",4],["12",3],["15",2],["18",1],["21",0]].filter((e=>e[0]===n))[0][1],r=e.list.filter(((e,t)=>t>o));return{dayPlusOneForecast:r.filter(((e,t)=>t<=7)),dayPlusTwoForecast:r.filter(((e,t)=>t>=8&&t<=15)),dayPlusThreeForecast:r.filter(((e,t)=>t>=16&&t<=23))}}(this.obj),f=n(w.dayPlusOneForecast),$=n(w.dayPlusTwoForecast),b=n(w.dayPlusThreeForecast);s.textContent=`${f} ${"metric"===this.units?"°C":"°F"}`,a.textContent=`${$} ${"metric"===this.units?"°C":"°F"}`,h.textContent=`${b} ${"metric"===this.units?"°C":"°F"}`;const S=t(w.dayPlusOneForecast),q=t(w.dayPlusTwoForecast),C=t(w.dayPlusThreeForecast);c.textContent=S,l.textContent=q,y.textContent=C;const F=o(S,w.dayPlusOneForecast),x=o(q,w.dayPlusTwoForecast),T=o(C,w.dayPlusThreeForecast);u.src=F,u.alt=S,d.src=x,d.alt=q,p.src=T,p.alt=C}static populateCountry(e,t){const n=e.filter((e=>e.cca2===t[0].country)),o=n[0].name.common,r=n[0].flags,s=t[0].name;document.querySelector(".city-name").innerHTML=`${s}, </br> ${o}`;const c=document.querySelector(".city > img");c.src=r.svg,c.alt=r.alt}}const u=document.getElementById("city-input"),i=document.getElementById("units");async function a(t){const n=new e;try{const e=await fetch(n.getGeocodeUrl(t),{mode:"cors"});return await e.json()}catch(e){console.log(e)}}async function l(t,n){const o=await async function(t,n){try{const o=await a(t),r=await async function(t,n,o){const r=new e;try{const e=await fetch(r.getForecastUrl(t,n,o),{mode:"cors"});return await e.json()}catch(e){console.log(e)}}(o[0].lat,o[0].lon,n);return r}catch(e){console.log(e)}}(t,n);new c(o,n).populateUI();const r=await a(t),s=await async function(t){const n=new e;try{const e=await fetch(n.getRestcountriesUrl(t),{mode:"cors"});return await e.json()}catch(e){console.log(e)}}(r[0].country);c.populateCountry(s,r)}document.getElementById("search-button").addEventListener("click",(async e=>{e.preventDefault();const t=u.value,n=i.value;t?l(t,n):l("osaka","metric")})),l("osaka","metric")})();
//# sourceMappingURL=main.js.map